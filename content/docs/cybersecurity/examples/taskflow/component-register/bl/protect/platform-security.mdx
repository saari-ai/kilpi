---
title: "PR.PS: Platform Security"
description: Billing Portal example for platform security
---

For methodology guidance, see [PR.PS: Platform Security](/docs/cybersecurity/functions/protect/platform-security).

---

### PR.PS-01: Configuration management

| Component | Baseline source | Key settings | Deviation notes |
|---|---|---|---|
| Billing API (Express) | OWASP Node.js security checklist | Helmet middleware (CSP, X-Frame-Options, X-Content-Type-Options), CORS whitelist restricted to billing SPA origin, request size limits | None |
| Billing database (PostgreSQL on RDS) | AWS RDS best practices | SSL enforced, public access disabled, minor version auto-upgrade enabled | None |
| Stripe SDK | Stripe security best practices | API version pinned, webhook signature verification enabled, restricted API key scope | None |
| AWS IAM | Least privilege principle | Roles scoped to billing-specific services, no wildcard permissions, MFA on root account | None |

---

### PR.PS-02: Software maintenance

| Component type | Patching approach | SLA (critical / high / medium) | EOL tracking |
|---|---|---|---|
| npm dependencies (direct) | Dependabot PRs, manual triage | Critical: 48h / High: 48h / Medium: 2 weeks | Package EOL announcements monitored |
| npm dependencies (transitive) | Dependabot PRs, `npm audit` | Critical: 48h / High: 1 week / Medium: 2 weeks | Transitive dependency health checked monthly |
| Node.js runtime | LTS version, upgrade within 30 days of release | Critical: 7 days / High: 14 days / Medium: 30 days | Node.js LTS schedule tracked |
| PostgreSQL | AWS RDS managed minor upgrades | Critical: AWS applies / High: next maintenance window / Medium: next quarter | RDS EOL notifications monitored |
| Stripe SDK | Pinned version, upgraded on Stripe API version changes | Critical: 48h / High: 1 week / Medium: 2 weeks | Stripe API version deprecation tracked |

**Controls:** <span style={{whiteSpace: 'nowrap'}}>SC-BL-7.1</span> (automated dependency scanning blocks merge on critical/high CVEs)

---

### PR.PS-03: Hardware maintenance

The Billing Portal runs entirely on AWS managed infrastructure. Hardware maintenance is delegated to AWS under the shared responsibility model. AWS handles hardware replacement, firmware updates, and physical security.

---

### PR.PS-04: Logging

| Log source | Format | Destination | Retention | Sensitive data |
|---|---|---|---|---|
| Billing API request logs | JSON (method, path, status, response time, customer ID) | Centralized log aggregation (CloudWatch) | 90 days | Low -- no request bodies logged |
| Billing operation audit log | JSON (event type, actor, action, amount, invoice ID, timestamp) | Centralized log aggregation (CloudWatch) + append-only audit table | 2 years (financial compliance) | Medium -- contains billing amounts and invoice references |
| Admin action audit log | JSON (actor, action, target, timestamp) | Centralized log aggregation (CloudWatch) + append-only audit table | 2 years (compliance) | Low -- actions only, no data payloads |
| Stripe webhook logs | JSON (event type, signature validation result, processing outcome) | Centralized log aggregation (CloudWatch) | 1 year | Low -- no payment data logged |
| Error logs | JSON (error type, correlation ID, sanitised message) | Centralized log aggregation (CloudWatch) | 90 days | High risk mitigated -- stack traces logged internally only, never in responses. Log masking strips secrets (<span style={{whiteSpace: 'nowrap'}}>SC-BL-5.2</span>). |

**Controls:** <span style={{whiteSpace: 'nowrap'}}>SC-BL-6.1</span> (billing operation audit log), <span style={{whiteSpace: 'nowrap'}}>SC-BL-6.2</span> (admin action audit log), <span style={{whiteSpace: 'nowrap'}}>SC-BL-5.2</span> (log masking middleware)

---

### PR.PS-05: Software integrity

| Control | Scope | Implementation |
|---|---|---|
| Lock files | All npm dependencies | `package-lock.json` committed, `npm ci` used in CI (no implicit upgrades) |
| Stripe SDK version pinning | Stripe integration | Stripe SDK pinned to explicit version in package.json, upgraded manually with changelog review |
| Pre-commit secret scanning | All code commits | Gitleaks runs pre-commit and in CI. Blocks commits containing secret patterns (Stripe keys, DB credentials). |
| CI build verification | All production deployments | Only CI-built artifacts are deployed. No manual builds reach production. |
| Docker image pinning | Base images | Pinned to SHA digest, not mutable tags. Rebuilt when base image is updated. |

---

### PR.PS-06: Secure development practices

| Practice | When it runs | Tool / method | Failure action |
|---|---|---|---|
| Schema validation | Every billing API request | Zod/Joi middleware validates request bodies against billing-specific schema | Request rejected with 400 |
| Parameterised query enforcement | Every database query | ORM (Sequelize/Knex) with linting rule against string concatenation | PR blocked by linting rule |
| Output encoding | Every render | React auto-escaping + review for `dangerouslySetInnerHTML` (must be zero) | PR blocked if found |
| Payment amount validation | Every payment-related request | Server-side validation of amounts against Stripe session / subscription | Request rejected with 400 |
| Secret scanning | Every commit + every CI build | Gitleaks (pre-commit hook + CI step) | Commit blocked / CI build fails |
| Dependency scanning | Every PR + daily | Dependabot + `npm audit` | PR blocked on critical/high CVEs |
| Code review | Every PR | Peer review with billing security checklist | PR cannot be merged without approval |

---
