---
title: "PR.PS: Platform Security"
description: Build Pipeline example for platform-security
---

For methodology guidance, see [PR.PS: Platform Security](/docs/cybersecurity/functions/protect/platform-security).

---

### PR.PS-01: Configuration management

| Component | Baseline source | Key settings | Deviation notes |
|---|---|---|---|
| GitHub Actions workflows | SLSA Build L2 requirements, GitHub security hardening guide | `permissions:` block set to minimal per-job, `pull_request` trigger (not `pull_request_target`), no `workflow_dispatch` with untrusted inputs | None |
| Branch protection (main) | GitHub branch protection best practices | Required reviews (minimum 1), require signed commits, dismiss stale reviews, restrict push access, no admin bypass | None |
| ECR repository | AWS ECR security best practices | Image scanning enabled, immutable tags, lifecycle policy (90 days), encryption at rest | None |
| OIDC trust policy | AWS IAM OIDC best practices | Subject claim restricted to `repo:<org>/<repo>:ref:refs/heads/main`, audience claim set to `sts.amazonaws.com` | None |
| GitHub Secrets | GitHub security best practices | Environment-scoped secrets (not org-wide), no secrets accessible from forks | None |

---

### PR.PS-02: Software maintenance

| Component type | Patching approach | SLA (critical / high / medium) | EOL tracking |
|---|---|---|---|
| Third-party GitHub Actions | Pinned to SHA. Updated quarterly after code review of changes between pinned SHAs. | Critical: 48h / High: 1 week / Medium: quarterly update cycle | Action deprecation notices monitored |
| npm dependencies (CI-specific) | Dependabot PRs, `npm audit` in CI | Critical: 48h / High: 48h / Medium: 2 weeks | Package EOL announcements monitored |
| Docker base images | Pinned to digest. Rebuilt when base image receives security patch. | Critical: 24h / High: 7 days / Medium: 30 days | Base image support lifecycle tracked |
| GitHub-hosted runner images | GitHub-managed updates | N/A (GitHub responsibility) | ubuntu-latest deprecation schedule tracked |
| Node.js version in CI | LTS version, aligned with application | Critical: 7 days / High: 14 days / Medium: 30 days | Node.js LTS schedule tracked |

**Controls:** <span style={{whiteSpace: 'nowrap'}}>SC-CI-2.1</span> (pin Actions to SHA, not mutable tags), <span style={{whiteSpace: 'nowrap'}}>SC-CI-5.1</span> (automated dependency scanning blocks merge on critical/high CVEs)

---

### PR.PS-03: Hardware maintenance

The build pipeline runs on GitHub-hosted ephemeral runners. Hardware maintenance is managed entirely by GitHub. Runner VMs are destroyed after each job, ensuring a clean environment for every build.

---

### PR.PS-04: Logging

| Log source | Format | Destination | Retention | Sensitive data |
|---|---|---|---|---|
| Workflow run logs | GitHub Actions log format (step-by-step output) | GitHub Actions log storage | 90 days | High risk mitigated -- GitHub masks secrets automatically. Additional regex scrubbing for encoded secrets (<span style={{whiteSpace: 'nowrap'}}>SC-CI-3.2</span>). |
| GitHub audit log | GitHub native format (actor, action, target, timestamp) | GitHub audit log (Enterprise) or API export | 6 months (Enterprise) | Low -- actions and metadata only |
| ECR image push events | CloudTrail format | CloudTrail S3 bucket | 1 year | Low -- image metadata and IAM principal only |
| Branch protection changes | GitHub audit log | GitHub audit log + CloudTrail (if GitHub Enterprise) | 6 months | Low -- configuration changes only |
| OIDC token requests | CloudTrail (STS AssumeRoleWithWebIdentity) | CloudTrail S3 bucket | 1 year | Medium -- contains repo and branch claims |

**Controls:** <span style={{whiteSpace: 'nowrap'}}>SC-CI-6.1</span> (workflow run audit log), <span style={{whiteSpace: 'nowrap'}}>SC-CI-3.2</span> (secret scanning in logs)

---

### PR.PS-05: Software integrity

| Control | Scope | Implementation |
|---|---|---|
| Action pinning to SHA | All third-party GitHub Actions | Actions referenced by full commit SHA (e.g., `actions/checkout@a5ac7e...`), not mutable tags. (<span style={{whiteSpace: 'nowrap'}}>SC-CI-2.1</span>) |
| Commit signing | All commits to main branch | Branch protection requires verified GPG or SSH signatures. Unsigned commits cannot be merged. (<span style={{whiteSpace: 'nowrap'}}>SC-CI-1.2</span>) |
| Image signing | All production Docker images | Images signed with cosign (Sigstore) after build. Signature verified before deployment. (<span style={{whiteSpace: 'nowrap'}}>SC-CI-4.1</span>) |
| Provenance attestation | All production builds | SLSA provenance generated by GitHub Actions, attested to image via cosign. (<span style={{whiteSpace: 'nowrap'}}>SC-CI-4.2</span>) |
| Dependency lockfiles | All package managers | `package-lock.json` committed, `npm ci` used in CI (no implicit upgrades). (<span style={{whiteSpace: 'nowrap'}}>SC-CI-4.3</span>) |
| Pre-commit secret scanning | All code commits | Gitleaks runs pre-commit and in CI. Blocks commits containing secret patterns. |

---

### PR.PS-06: Secure development practices

| Practice | When it runs | Tool / method | Failure action |
|---|---|---|---|
| Workflow file review | Every PR modifying `.github/workflows/` | Peer review with pipeline security checklist (CODEOWNERS for workflow files) | PR blocked until approved by infrastructure owner |
| Action allow-list enforcement | Every workflow run | Only pre-approved Actions (pinned to SHA) permitted. `actions/` org Actions reviewed quarterly. | Workflow fails if unapproved Action is referenced |
| Secret scanning | Every commit + every CI build | Gitleaks (pre-commit hook + CI step) + GitHub secret scanning | Commit blocked / CI build fails |
| Dependency scanning | Every PR + daily | Dependabot + `npm audit` + Trivy (container images) | PR blocked on critical/high CVEs |
| OIDC claim validation | Every deployment | AWS IAM trust policy validates repo, branch, and environment claims | STS AssumeRole denied if claims do not match |
| Image provenance check | Every deployment | cosign verify-attestation against SLSA provenance | Deployment blocked if provenance is missing or invalid |

---
