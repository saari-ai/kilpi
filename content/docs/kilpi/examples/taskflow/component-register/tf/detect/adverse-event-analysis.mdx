---
title: "DE.AE: Adverse Event Analysis"
description: Taskflow example for adverse event analysis
---

For methodology guidance, see [DE.AE: Adverse Event Analysis](/docs/kilpi/functions/detect/adverse-event-analysis).

---

### DE.AE-02: Event analysis

| Alert source | Analysis method | Triage outcome |
|---|---|---|
| Input validation failure spikes | Correlate with specific IPs and endpoints. A single IP hitting multiple endpoints with invalid payloads is a stronger signal than distributed failures across many IPs. | Automated probing (block IP) vs legitimate user errors (no action) |
| Authentication failure spikes | Distinguish credential stuffing (many accounts from one IP) from brute force (one account from many IPs). Both are attacks but indicate different threat actors and require different containment. | Credential stuffing: block IP range. Brute force: lock account + notify user. |
| Webhook signature failures | Correlate with source IPs. Invalid signatures from non-Stripe IPs are likely spoofing. Valid signatures with abnormal volume could indicate Stripe-side issues or replay attacks. Cross-reference Stripe status page. | Spoofing attempt (block IP, investigate) vs Stripe platform issue (monitor) |
| Audit log gaps | Correlate with deployment events. Missing entries may indicate a logging failure or intentional log tampering. | Infrastructure issue (fix logging) vs adversarial behaviour (escalate to incident) |
| S3 policy change alerts | Correlate with change management records. Distinguish intentional changes from drift or compromise. | Authorized change (acknowledge) vs unauthorized change (immediate containment) |

---

### DE.AE-03: Cross-source correlation

| Source A | Source B | Correlation method | Combined signal |
|---|---|---|---|
| Redis connection logs (external IP) | VPC flow logs (ALLOW from non-VPC source) | IP match + time window | Confirmed external Redis access -- always an incident regardless of volume |
| Password change event | Session invalidation event | Same user ID, within 5-second window | Missing correlation = session invalidation failure (<span style={{whiteSpace: 'nowrap'}}>SC-TF-3.3</span> not working) |
| Secret pattern in logs | Secrets manager access log | Key identity match + time window | Determines if leaked secret was accessed by unauthorized party during exposure window |
| Failed login spikes | Account lockout events | Same account/IP + time window | Confirms rate limiter (<span style={{whiteSpace: 'nowrap'}}>SC-TF-2.1</span>) is functioning. Absence of lockout during spike = control failure. |
| Admin action in app logs | Audit log entry | Same actor + action + target, within 5 seconds | Missing audit entry = logging gap (investigate) |

---

### DE.AE-04: Impact and scope estimation

| Event | Affected systems | Affected data | Estimated severity |
|---|---|---|---|
| External Redis connection | Redis session store, all active user sessions | All session tokens, cached data | Critical -- potential session hijacking for any active user |
| S3 bucket made public | S3 attachment bucket | All user file attachments | Critical -- all user files exposed to internet |
| Secret found in logs | Depends on which secret (Stripe key, SendGrid key) | Payment data (Stripe) or email capability (SendGrid) | Critical -- immediate credential rotation required |
| DDL executed by app user | PostgreSQL database | All database tables | Critical -- indicates SQL injection or privilege escalation |
| Brute force (single account) | Authentication system | One user's account | High -- single account compromise |
| Credential stuffing (many accounts) | Authentication system | Multiple user accounts | Critical -- broad account compromise potential |

---

### DE.AE-06: Alert routing and notification

| Alert severity | Route to | Method | SLA |
|---|---|---|---|
| Critical | On-call engineer (pager) + security lead + engineering Slack channel | PagerDuty page + Slack alert | Paged within 5 minutes. Response within 15 minutes. |
| High | Security lead + engineering Slack channel | Slack alert + email | Alert within 30 minutes. Investigation started within 4 hours. |
| Medium | Weekly security review queue | Slack alert (low priority) + dashboard ticket | Included in next weekly review. Triaged within 7 days. |

---

### DE.AE-07: Threat intelligence integration

| Intelligence type | Source | Integration point | Update cadence |
|---|---|---|---|
| Known CVE data | GitHub Advisory Database, NVD | Dependabot scans, `npm audit` | Continuous (automated) |
| MITRE ATT&CK techniques | MITRE ATT&CK knowledge base | Threat model classification (T-codes in threat register) | Referenced during quarterly threat review |
| Stripe webhook IP ranges | Stripe documentation | Webhook source IP validation | Quarterly update check |
| AWS IP ranges | AWS published IP ranges | CloudTrail source IP validation | Automatic (AWS updates) |

---

### DE.AE-08: Incident declaration

| Criterion | Threshold | Example |
|---|---|---|
| Confirmed data access by unauthorized party | Any confirmed access | S3 bucket accessed while public, cross-user file download, database exfiltration |
| Credential compromise confirmed | Any leaked secret used by unauthorized party | Stripe key used for unauthorized charges, SendGrid key used to send phishing |
| Active exploitation in progress | Attack is ongoing and controls are not containing it | Brute force bypassing rate limiter, injection succeeding despite parameterisation |
| Control failure confirmed | A control expected to prevent an attack type is not functioning | Redis accessible from outside VPC, S3 BlockPublicAccess disabled, audit logging not recording |
| Critical CVE actively exploited in the wild | Exploit code published + vulnerable code path reachable in Taskflow | npm dependency with published exploit affecting a function Taskflow uses |

---
