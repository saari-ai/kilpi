---
title: "PR.DS: Data Security"
description: Taskflow example for data security
---

For methodology guidance, see [PR.DS: Data Security](/docs/kilpi/functions/protect/data-security).

---

### PR.DS-01: Data at rest

| Data store | Encryption method | Key management | Key rotation |
|---|---|---|---|
| PostgreSQL (RDS) | AES-256 (AWS RDS encryption) | AWS KMS managed | Annually (AWS managed) |
| Redis (ElastiCache) | AES-256 (ElastiCache encryption at rest) | AWS KMS managed | Annually (AWS managed) |
| S3 (attachments bucket) | AES-256 (SSE-S3) | AWS managed | Automatic (AWS managed) |
| Secrets manager | AES-256 (AWS Secrets Manager) | AWS KMS managed | Annually (AWS managed) |

**Controls:** <span style={{whiteSpace: 'nowrap'}}>SC-TF-1.1</span> (parameterised queries protect data integrity), <span style={{whiteSpace: 'nowrap'}}>SC-TF-4.2</span> (S3 BlockPublicAccess), <span style={{whiteSpace: 'nowrap'}}>SC-TF-5.1</span> (secrets in env/manager), <span style={{whiteSpace: 'nowrap'}}>SC-TF-7.2</span> (sanitised error responses prevent data leakage)

---

### PR.DS-02: Data in transit

| Communication path | Protocol | Minimum version | Additional controls |
|---|---|---|---|
| Browser to API | HTTPS | TLS 1.2 | HSTS header, certificate managed via AWS ACM |
| API to PostgreSQL | TLS | TLS 1.2 | Within VPC, RDS enforces SSL connections |
| API to Redis | TLS | TLS 1.2 | Within VPC, ElastiCache in-transit encryption enabled |
| API to S3 | HTTPS | TLS 1.2 | AWS SDK enforces HTTPS by default |
| API to Stripe | HTTPS | TLS 1.2 | Stripe SDK enforces HTTPS |
| API to SendGrid | HTTPS | TLS 1.2 | SendGrid SDK enforces HTTPS |
| Stripe webhooks to API | HTTPS | TLS 1.2 | HMAC signature validation (<span style={{whiteSpace: 'nowrap'}}>SC-TF-6.1</span>) |

**Controls:** <span style={{whiteSpace: 'nowrap'}}>SC-TF-1.3</span> (CSRF tokens on state-changing requests), <span style={{whiteSpace: 'nowrap'}}>SC-TF-5.2</span> (log masking prevents secrets in transit via logs), <span style={{whiteSpace: 'nowrap'}}>SC-TF-6.1</span> (webhook signature validation)

---

### PR.DS-10: Data in use

| Control | What it covers | Implementation |
|---|---|---|
| No secrets in client bundles | API keys, tokens, and credentials never included in React SPA build output | Build-time environment variable separation. Only `REACT_APP_*` public vars are bundled. Secret scanning of build artifacts. |
| Password hashing before storage | Raw passwords never persisted, even temporarily | bcrypt with cost factor 12 applied before any write. Raw password cleared from memory after hashing. |
| Log masking middleware | Sensitive data stripped before logging | Middleware scans for patterns (`sk_live_`, `SG.`, bearer tokens, bcrypt hashes) and replaces with `[REDACTED]` before log output. |
| Generic error responses | Internal state not exposed in API responses | Error handler returns message + correlation ID only. Stack traces, paths, and versions logged internally only (<span style={{whiteSpace: 'nowrap'}}>SC-TF-7.2</span>). |

---

### PR.DS-11: Backups

| Data source | Backup frequency | Storage location | Encryption | Restore test cadence |
|---|---|---|---|---|
| PostgreSQL (RDS) | Daily automated snapshots + continuous WAL archiving (point-in-time recovery) | AWS RDS automated backups (same region) + cross-region copy | AES-256 (KMS) | Quarterly |
| S3 (attachments) | Versioning enabled, cross-region replication | S3 secondary bucket (different region) | AES-256 (SSE-S3) | Semi-annually |
| Redis | No backup (ephemeral session data, rebuilt on restart) | N/A | N/A | N/A |
| Secrets manager | AWS-managed redundancy | AWS Secrets Manager (multi-AZ) | AES-256 (KMS) | Annually (verify recovery) |

---
