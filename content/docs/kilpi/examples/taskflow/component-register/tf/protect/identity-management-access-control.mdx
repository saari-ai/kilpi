---
title: "PR.AA: Identity Management, Authentication, and Access Control"
description: Taskflow example for identity management, authentication, and access control
---

For methodology guidance, see [PR.AA: Identity Management, Authentication, and Access Control](/docs/kilpi/functions/protect/identity-management-access-control).

---

### PR.AA-01: Identity and credential management

| Identity type | Credential type | Provisioning | Rotation schedule | Revocation trigger |
|---|---|---|---|---|
| End user (email/password) | Password (bcrypt cost 12) | Self-registration with email verification | User-initiated. Forced after compromise. | Account deletion or admin lockout. |
| End user (Google OAuth) | OAuth token (Google-managed) | Google OAuth flow, redirect URI whitelisted | Managed by Google. Session TTL 4 hours. | Account deletion or OAuth de-linkage. |
| API service (Stripe) | Secret API key | Generated in Stripe dashboard, stored in secrets manager | Quarterly | Key compromise detected. |
| API service (SendGrid) | API key | Generated in SendGrid dashboard, stored in secrets manager | Quarterly | Key compromise detected. |
| Database (app user) | PostgreSQL password | Provisioned via infrastructure-as-code | Quarterly | Infrastructure rotation cycle. |

**Controls:** <span style={{whiteSpace: 'nowrap'}}>SC-TF-2.1</span> (login rate limiting), <span style={{whiteSpace: 'nowrap'}}>SC-TF-2.4</span> (password reset rate limiting and token expiry)

---

### PR.AA-02: Identity proofing

| Identity type | Proofing method | Binding |
|---|---|---|
| End user (email/password) | Email verification link sent during registration. Link expires after 24 hours. | Email address verified before account is activated. |
| End user (Google OAuth) | Google verifies identity. Taskflow trusts Google's proofing. | Bound to Google account email. |
| Admin user | Same as end user, plus manually granted admin role by existing admin. | Role assignment recorded in audit log. |

**Controls:** <span style={{whiteSpace: 'nowrap'}}>SC-TF-2.2</span> (bcrypt/argon2id hashing for password-based identities)

---

### PR.AA-03: Authentication methods

| Actor | Auth method | MFA required | Password / credential policy | Reauthentication |
|---|---|---|---|---|
| End user (password) | Email + password, session cookie | Not yet (planned Q2) | Min 8 chars, no known-breached passwords (HaveIBeenPwned check) | Session expires after 24h inactivity, 7 days absolute |
| End user (OAuth) | Google OAuth 2.0, session cookie | Deferred to Google | N/A (Google-managed) | Session expires after 4h (shorter TTL for single-factor OAuth) |
| API to Stripe | Server-side API key | N/A | Key stored in secrets manager, rotated quarterly | Per-request authentication via key |
| API to SendGrid | Server-side API key | N/A | Key stored in secrets manager, rotated quarterly | Per-request authentication via key |
| Stripe webhooks | HMAC signature (Stripe-Signature header) | N/A | Signing secret stored in secrets manager | Per-request signature validation |

**Controls:** <span style={{whiteSpace: 'nowrap'}}>SC-TF-2.1</span> (rate limiting), <span style={{whiteSpace: 'nowrap'}}>SC-TF-2.3</span> (OAuth redirect whitelist)

---

### PR.AA-04: Identity assertions

| Assertion type | Standard | Protection | Verification |
|---|---|---|---|
| Session cookie | HTTP cookie (HttpOnly, Secure, SameSite=Lax) | Not readable by client JavaScript. Transmitted only over HTTPS. | Server-side session lookup in Redis on every request. |
| OAuth access token | OAuth 2.0 / OpenID Connect | Short-lived, exchanged server-side only | Validated against Google's token endpoint during login flow. |
| Stripe webhook signature | HMAC-SHA256 | Signing secret stored in secrets manager | Signature verified on every webhook request before processing. |

---

### PR.AA-05: Access permissions and least privilege

| Role / principal | Access scope | Model | Review cadence |
|---|---|---|---|
| End user | Own projects, tasks, files only. Cannot access other users' data. | Application-level tenant isolation (user ID in all queries) | Continuous (enforced by code) |
| Admin user | All users in their workspace. User management, billing, role assignment. | Role-based access control (RBAC) | Quarterly |
| Application DB user | SELECT, INSERT, UPDATE, DELETE only. No DDL. No system tables. | PostgreSQL role with explicit grants | Quarterly (infrastructure review) |
| S3 file access | Per-file authorization check before pre-signed URL generation. URLs expire after 15 minutes. | Application-level check + time-limited URL | Continuous (enforced by code) |

**Controls:** <span style={{whiteSpace: 'nowrap'}}>SC-TF-4.1</span> (least-privilege DB user), <span style={{whiteSpace: 'nowrap'}}>SC-TF-4.3</span> (signed URLs with auth check), <span style={{whiteSpace: 'nowrap'}}>SC-TF-3.2</span> (session expiry), <span style={{whiteSpace: 'nowrap'}}>SC-TF-3.3</span> (session invalidation on password change)

---

### PR.AA-06: Physical access

Taskflow runs entirely on AWS managed infrastructure. There is no physical hardware managed by the organization. Physical access controls are delegated to AWS under the shared responsibility model. AWS maintains SOC 2 and ISO 27001 certifications covering physical security of data centers.

---
