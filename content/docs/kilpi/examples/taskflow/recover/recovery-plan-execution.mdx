---
title: "RC.RP: Recovery Plan Execution"
description: Taskflow example for recovery plan execution
---

For methodology guidance, see [RC.RP: Recovery Plan Execution](/docs/kilpi/functions/recover/recovery-plan-execution).

---

### RC.RP-01: Recovery initiation

| Pre-recovery check | Status |
|---|---|
| Containment confirmed (attack vector blocked, no ongoing exploitation) | Must be verified |
| Scope determined (all affected systems and data identified) | Must be confirmed |
| Evidence preserved (logs, database snapshots saved) | Must be completed |
| Stakeholders notified per escalation matrix | Must be completed |

**Recovery procedures by incident type:**

**Credential compromise** (<span style={{whiteSpace: 'nowrap'}}>ST-TF-3</span>, <span style={{whiteSpace: 'nowrap'}}>ST-TF-11</span>, <span style={{whiteSpace: 'nowrap'}}>ST-TF-13</span>, <span style={{whiteSpace: 'nowrap'}}>ST-TF-15</span>): Rotate all compromised credentials. For API key leaks: generate new keys in Stripe/SendGrid, update secrets manager, deploy. For credential stuffing: force password reset on affected accounts. For weak hashing: re-hash all passwords with bcrypt/argon2id, invalidate all sessions.

**Session hijacking** (<span style={{whiteSpace: 'nowrap'}}>ST-TF-7</span>, <span style={{whiteSpace: 'nowrap'}}>ST-TF-8</span>, <span style={{whiteSpace: 'nowrap'}}>ST-TF-17</span>): Flush all sessions in Redis. Every user must re-authenticate. If Redis was network-exposed: take offline, reconfigure to VPC-only, bring back online.

**Data exposure** (<span style={{whiteSpace: 'nowrap'}}>ST-TF-6</span>, <span style={{whiteSpace: 'nowrap'}}>ST-TF-9</span>, <span style={{whiteSpace: 'nowrap'}}>ST-TF-10</span>): Revoke excess DB privileges. Enable S3 BlockPublicAccess. Fix authorization in URL generation, invalidate outstanding pre-signed URLs by rotating signing key.

**Application attack** (<span style={{whiteSpace: 'nowrap'}}>ST-TF-1</span>, <span style={{whiteSpace: 'nowrap'}}>ST-TF-2</span>, <span style={{whiteSpace: 'nowrap'}}>ST-TF-5</span>): Deploy patched code. If data was modified: restore from last known-good backup. For XSS: remove stored malicious content, deploy output encoding fix. Invalidate sessions of affected users.

**Dependency compromise** (<span style={{whiteSpace: 'nowrap'}}>ST-TF-20</span>): Update or remove vulnerable dependency. If RCE: rebuild server from known-good image, rotate all secrets, restore data from backup if integrity is uncertain.

---

### RC.RP-02: Recovery prioritization

| Priority | Category | Systems | Justification |
|---|---|---|---|
| 1 | Authentication and session integrity | Auth system, Redis, session store | Users cannot use the product without working auth. All other recovery depends on trusted sessions. |
| 2 | Data integrity and access controls | PostgreSQL, S3, file access | Core data must be intact and properly protected before users access it. |
| 3 | Payment processing | Stripe integration, webhook processing | Revenue-critical. Must verify no unauthorized charges before re-enabling. |
| 4 | Email delivery | SendGrid integration | Important for notifications but not blocking for core product use. |
| 5 | Monitoring and observability | Audit logs, detection rules | Must be restored to detect any follow-on attacks, but core service is already functional. |

---

### RC.RP-03: Backup verification

| Backup | IOC scan result | Integrity check | Safe restore point |
|---|---|---|---|
| PostgreSQL RDS snapshot (daily) | Verify no injected data or unauthorized schema changes in snapshot | Row counts and checksums compared to expected values | Latest snapshot before incident start time |
| PostgreSQL WAL (point-in-time) | Can restore to any second within retention window | Transaction log integrity verified by RDS | Exact timestamp before first evidence of exploitation |
| S3 versioned objects | Verify no malicious uploads in restored versions | File checksums compared to pre-incident versions | Version prior to unauthorized access window |

---

### RC.RP-04: Post-incident operational norms

| Adjustment | Details | Duration |
|---|---|---|
| Tighter rate limiting | Lower login rate limit from 5/min to 3/min during monitoring period | 2 weeks post-incident, then reassess |
| Enhanced monitoring | Lower alert thresholds for the incident type that occurred | 30 days, then reassess |
| Forced credential rotation | All API keys rotated, all user sessions invalidated | One-time action |
| Additional logging | Increase log verbosity for affected systems | 2 weeks post-incident |

**Feedback loop -- every recovery updates earlier functions:**

| Recovery type | Identify update | Protect update | Detect update |
|---|---|---|---|
| Credential compromise | Re-score <span style={{whiteSpace: 'nowrap'}}>ST-TF-3</span>, <span style={{whiteSpace: 'nowrap'}}>ST-TF-11</span>, <span style={{whiteSpace: 'nowrap'}}>ST-TF-13</span>, <span style={{whiteSpace: 'nowrap'}}>ST-TF-15</span> likelihood | Strengthen <span style={{whiteSpace: 'nowrap'}}>SC-TF-2.1</span>, <span style={{whiteSpace: 'nowrap'}}>SC-TF-2.2</span>, <span style={{whiteSpace: 'nowrap'}}>SC-TF-5.1</span>, <span style={{whiteSpace: 'nowrap'}}>SC-TF-5.2</span> | Lower alert thresholds for failed login spikes. Add secret pattern alerts. |
| Session hijacking | Re-score <span style={{whiteSpace: 'nowrap'}}>ST-TF-7</span>, <span style={{whiteSpace: 'nowrap'}}>ST-TF-8</span>, <span style={{whiteSpace: 'nowrap'}}>ST-TF-17</span> | Add IaC enforcement for <span style={{whiteSpace: 'nowrap'}}>SC-TF-3.1</span>. Add TTL drift monitoring. Add CI test for <span style={{whiteSpace: 'nowrap'}}>SC-TF-3.3</span>. | Add Redis port access monitoring. Alert on sessions exceeding TTL. |
| Data exposure | Re-score <span style={{whiteSpace: 'nowrap'}}>ST-TF-6</span>, <span style={{whiteSpace: 'nowrap'}}>ST-TF-9</span>, <span style={{whiteSpace: 'nowrap'}}>ST-TF-10</span> | Lock <span style={{whiteSpace: 'nowrap'}}>SC-TF-4.1</span> with IaC. Add AWS Config rule for <span style={{whiteSpace: 'nowrap'}}>SC-TF-4.2</span>. Add cross-tenant tests for <span style={{whiteSpace: 'nowrap'}}>SC-TF-4.3</span>. | Add unusual DB query volume alerts. Add S3 public access monitoring. |
| Application attack | Re-score <span style={{whiteSpace: 'nowrap'}}>ST-TF-1</span>, <span style={{whiteSpace: 'nowrap'}}>ST-TF-2</span>, <span style={{whiteSpace: 'nowrap'}}>ST-TF-5</span> | Add static analysis gate for <span style={{whiteSpace: 'nowrap'}}>SC-TF-1.1</span>. Add XSS test suite for <span style={{whiteSpace: 'nowrap'}}>SC-TF-1.2</span>. Expand <span style={{whiteSpace: 'nowrap'}}>SC-TF-1.4</span>. | Add WAF signatures from actual payloads. Lower validation failure thresholds. |
| Dependency compromise | Re-score <span style={{whiteSpace: 'nowrap'}}>ST-TF-20</span>. Record CVE ID. | Tighten scan frequency in <span style={{whiteSpace: 'nowrap'}}>SC-TF-8.1</span>. Remove unused deps. | Increase scan frequency. Add runtime monitoring. |

---

### RC.RP-05: Restoration verification

| Verification step | Check | Result |
|---|---|---|
| Authentication working | Users can log in with both password and OAuth | Pass/Fail |
| Session management working | Sessions expire at configured TTL. Password change invalidates sessions. | Pass/Fail |
| Data integrity | Restored table row counts and checksums match backup | Pass/Fail |
| Access controls operational | Cross-user data access returns 403. DDL rejected for app user. S3 returns 403 for unauthenticated requests. | Pass/Fail |
| Payment processing working | Stripe API responds with new key. Webhook signature validation works. | Pass/Fail |
| Monitoring operational | Alerts fire for test events. Audit log entries are being created. | Pass/Fail |
| Secret management verified | Secret scan on repo: zero matches. Log search for key prefixes: zero matches. | Pass/Fail |

---

### RC.RP-06: After-action report and closure

| Report section | Content |
|---|---|
| Incident summary | What happened, when, severity level |
| Timeline | Detection time, containment time, resolution time, total exposure window |
| Root cause | Systemic cause and specific failure point |
| Impact | Affected users, affected data, financial impact |
| Response evaluation | What worked, what was slow, what was missed |
| Remediation actions | Controls added or strengthened, detection rules updated, policies changed |
| Open items | Follow-up work not yet complete |

**Closure criteria:**

| Criterion | Status |
|---|---|
| Root cause identified and fixed | Required |
| All affected controls verified operational | Required |
| Monitoring rules updated for incident type | Required |
| Threat register updated with re-scored likelihoods | Required |
| Customer notification sent (if applicable) | Required |
| Post-mortem document published to team | Required |
| Follow-up action items assigned with deadlines | Required |

---
